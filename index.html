<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      // Load the Visualization API and the corechart package.
      google.charts.load('current', {'packages':['corechart']});
      // Set a callback to run when the Google Visualization API is loaded.
      google.charts.setOnLoadCallback(drawChart);
      // Callback that creates and populates a data table,
      // instantiates the pie chart, passes in the data and
      // draws it.
      var x = 'AY';
      function drawChart() {
      var eID = document.getElementById("choose");
      x = eID.options[eID.selectedIndex].value;
      var div = document.getElementById('heading');
      div.innerHTML = eID.options[eID.selectedIndex].text;
      
      div = document.getElementById('bodytext');
      div.innerHTML = eID.options[eID.selectedIndex+1].text;
        
      var query = new google.visualization.Query(
          "https://docs.google.com/spreadsheets/d/164x1Na7AV2Wm58_HBtG8mFxQX3emOVtPl3wYAQbYS2Q/gviz/tq?sheet=Sheet1&headers=1&tq=select%20A%2C%20count(A)%20where%20A%20is%20not%20null%20and%20"+x+"%20is%20not%20null%20group%20by%20A%20%20pivot%20"+x);
      query.send(handleSampleDataQueryResponse);
    }
    function handleSampleDataQueryResponse(response) {
      if (response.isError()) {
        alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
        return;
      }
      var data = response.getDataTable();
      var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
      if (x=='AY')
        {
          chart.draw(data, { height: 600, width:'70%', chartArea: {'top':0, 'left':0,'width': '60%', 'height': '70%'}, 'legend':{position: 'right', maxLines: 15}, 'vAxis': {'title': 'People in Data Viz'}, 'hAxis': {'title': 'Years in Data Viz'} });
        }
        else{
          chart.draw(data, { height: 600, width:'70%', chartArea: {'top':0, 'left':0,'width': '60%', 'height': '70%'}, isStacked:'percent', 'legend':{position: 'right', maxLines: 15}, 'vAxis': {'title': 'People in Data Viz'}, 'hAxis': {'title': 'Years in Data Viz'} });
        }
    }
       
    </script>
  </head>

  <body onclick="next()">
    <h1 style="font-size: 50px; font-family: sans-serif; text-align: center; padding-top: 50px;">People in Data Viz</h1>
    <div style="padding: 0 200px;" >
      <div id="textbox" style="width: 30%; height: 600px; float: left;">
        <div id="heading" style="font-size: 30px; font-family: sans-serif; font-weight: bold;"></div>
        <div id="bodytext" style="font-size: 20px; font-family: sans-serif; margin-top: 10px;"></div>
      </div>
      <div id="chart_div" style="display: block; margin: 0; float: left; width: 70%; padding-top: 2px;"></div>
    </div>

    <div class="custom-select" style=" align-content: center; display: block; ">
    <select id="choose" style="display: block; margin: 0 auto;" onchange="drawChart()">
      <option value="AY" selected="selected">Years in Data Viz?</option>
      <option value="AZ">Everyone in DVS</option>
      <option value="B">Where did you learn Data Viz?</option>
      <option value="D">Skills to improve next?</option>
      <option value="E">Freelancer/consultant?</option>
      <option value="F">Focus of data visualization in your work?</option>
      <option value="G">Hired for Data Viz vs part of the job description?</option>
      <option value="H">Doing Data Viz vs expectations?</option>
      <option value="I">Your Role?</option>
      <option value="J">Yearly Pay?</option>
      <option value="M">Separate Data Viz Group vs Data Viz in a team?</option>
      <option value="X">Choosing your own tools?</option>
      <option value="AC">Audience uses Data Viz?</option>
      <option value="AE">What's your relationship with stakeholders?</option>
      <option value="AP">Spending time with Data Viz ahead?</option>
      <option value="AQ">Educational background?</option>
      <option value="AR">The organization you work for is in which of the following areas?</option>
      <option value="AS">Undergrad Major??</option>
      <option value="AT">Gender identity?</option>
      <option value="AU">LGBTQ+?</option>
      <option value="AZ"> </option>
    </select>
  </div>
   
  </body>
<script type="text/javascript">
  function next(){
      console.log("next") ;
      var sel = document.getElementById('choose');
      sel.selectedIndex++;
      if(sel.selectedIndex>=document.getElementById('choose').length-1){
        sel.selctedIndex=0;
      }  
      drawChart();
        }
</script>

</html>
